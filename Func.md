# Описание архитектуры и функциональности llm-go

Проект **llm-go** — Go-приложение для генерации, запуска и удаления Python-скриптов с помощью локальной LLM (например, Ollama), а также сбора информации о системе.

### Главные возможности

- Формирует запрос к локальной LLM-модели с целью генерации Python-кода по заданному промпту.
- Извлекает сгенерированный код, сохраняет его в файл, выполняет скрипт и удаляет его.
- Логирует и выводит системную информацию о обор��довании и ОС.

---

## Архитектура и основные компоненты

**Стартовая точка — `main.go`:**
- Инициализирует логирование (уровень INFO или DEBUG по переменной окружения).
- Получает и логирует аппаратную информацию (infra).
- Делает запрос в LLM через llm.CallLLM(prompt), где prompt — инструкция для генерации Python-скрипта.
- Обрабатывает полученный ответ: извлекает сам скрипт (scripts.ExtractScript), создает файл, запускает его на исполнение, затем удаляет.

**infra/**
- `infra/recon.go`:
  - Сбор информации о CPU, памяти, ОС (использует gopsutil).
    - `HardInfo()` — агрегирует отчет о платформе, CPU и памяти.
    - `GetCpu()`, `InfoCpu()`, `GetHost()`, `GetMemory()` — функции сбора отдельных метрик.

**llm/**
- `llm/llmcall.go`:
  - `CallLLM(prompt string)` — формирует HTTP POST-запрос к Ollama server для генерации текста по prompt.
  - Возвращает ответ модели (поле Response), который далее используется для извлечения кода.

**scripts/**
- `scripts/parser.go`:
  - `ExtractScript(response string)` — регуляркой извлекает содержимое кода Python из блока ```python ... ```
- `scripts/writescript.go`:
  - `CreateScript(script string)` — сохраняет строку в файл script.py;
  - `DeleteScript()` — удаляет файл script.py.
- `scripts/executer.go`:
  - `RunScript()` — запускает script.py с помощью python3, перенаправляя вывод в stdout/stderr.


---

## Пример основного workflow

1. Формируется промпт для LLM и отправляется через функцию CallLLM.
2. Из ответа выделяется блок кода (обычно markdown-блок с Python-кодом).
3. Код сохраняется в файл script.py.
4. script.py выполняется через python3.
5. По завершении работы временный скрипт удаляется.

---

## Используемые технологии

- Язык: Go (golang)
- Внешние библиотеки: logrus, gopsutil
- LLM: любой, совместимый с Ollama API (по умолчанию llama3)
- Взаимодействие с Python: через вызовы os/exec

---

## Основные функции и методы

- `infra.HardInfo()`, `infra.GetCpu()`, `infra.GetMemory()` — сбор аппаратной информации
- `llm.CallLLM(prompt string)` — запрос в LLM
- `scripts.ExtractScript(response string)` — извлечение кода из ответа
- `scripts.CreateScript(script string)`/`DeleteScript()` — запись/удаление файла
- `scripts.RunScript()` — исполнение Python-скрипта

---

## Примечания

- Для работы требуется запущенный локальный сервер Ollama.
- По умолчанию используется модель "llama3.2:3b".
- Зависит от наличия интерпретатора python3 и необходимых прав на создание/удаление файлов.
